#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f install.sh -o install-encrypted 
#endif

static  char data [] = 
#define      xecc_z	15
#define      xecc	((&data[1]))
	"\117\374\164\134\177\070\215\166\151\324\357\264\157\154\214\243"
	"\216\024\312"
#define      text_z	3453
#define      text	((&data[420]))
	"\060\224\047\307\176\072\040\057\376\201\203\112\144\031\203\167"
	"\230\256\267\232\165\015\013\073\135\231\120\047\157\307\322\240"
	"\134\372\147\332\064\207\012\063\011\216\176\156\247\001\345\100"
	"\260\235\332\045\253\346\141\010\200\262\060\357\171\002\217\325"
	"\375\366\260\062\176\273\145\210\111\344\366\360\346\334\061\226"
	"\171\014\274\045\362\035\055\162\317\135\142\111\140\362\037\135"
	"\351\320\220\147\213\365\360\324\332\346\305\300\302\366\127\074"
	"\003\023\141\365\061\217\150\001\355\313\113\116\275\152\253\246"
	"\072\073\016\306\061\376\232\014\345\140\315\247\127\044\344\132"
	"\070\106\120\152\326\271\153\303\204\267\021\101\042\275\350\135"
	"\371\366\043\053\365\276\067\332\036\004\202\165\051\146\320\142"
	"\255\041\314\203\332\070\106\137\357\130\241\021\025\211\156\017"
	"\200\221\072\165\120\162\120\156\166\322\344\240\071\264\002\346"
	"\325\316\151\260\007\257\017\366\007\260\010\035\072\167\054\272"
	"\011\146\060\131\331\200\307\117\122\253\357\213\140\362\161\066"
	"\300\333\346\307\213\365\276\223\246\306\260\340\076\335\232\107"
	"\104\313\240\035\113\150\154\235\024\134\051\164\116\233\252\017"
	"\166\220\327\001\206\225\224\055\134\105\015\232\042\250\342\146"
	"\163\203\203\277\353\360\134\377\115\206\163\234\041\036\254\230"
	"\257\203\231\066\031\056\143\166\164\161\021\226\032\363\375\216"
	"\166\201\115\142\162\252\141\277\060\325\134\122\363\010\352\243"
	"\214\204\331\245\263\075\033\047\257\055\276\312\040\273\130\227"
	"\075\246\371\257\121\133\157\202\060\313\324\044\323\277\307\137"
	"\103\241\005\367\337\041\036\216\116\335\130\157\231\261\007\326"
	"\127\000\205\251\133\365\053\214\300\377\260\224\276\170\364\002"
	"\032\361\277\373\144\126\124\061\174\000\137\177\236\006\301\073"
	"\056\060\001\146\267\305\151\053\045\136\351\014\103\176\065\155"
	"\366\336\246\321\223\273\267\104\347\235\222\233\217\226\045\314"
	"\304\140\201\033\250\027\347\202\367\357\276\355\304\131\030\267"
	"\220\023\017\170\175\052\260\075\237\326\236\115\144\140\207\265"
	"\032\122\232\066\204\350\270\116\106\127\224\016\070\177\357\214"
	"\043\334\050\341\166\125\330\076\354\244\122\334\224\031\155\137"
	"\005\335\107\344\132\061\174\003\061\224\013\215\165\004\130\160"
	"\114\053\265\152\306\361\077\163\162\377\356\162\370\327\322\225"
	"\225\262\305\011\263\173\371\042\155\002\100\044\131\377\000\041"
	"\045\373\336\047\137\016\371\343\161\036\163\316\352\301\332\202"
	"\074\065\237\345\177\147\376\343\275\120\333\374\327\226\017\057"
	"\356\063\074\135\272\026\034\340\326\143\147\146\164\232\363\066"
	"\114\337\037\145\334\353\135\136\312\341\240\102\114\362\244\124"
	"\001\103\017\000\241\132\264\374\247\227\230\254\113\264\362\353"
	"\316\215\166\127\014\134\214\354\157\027\152\151\051\145\000\037"
	"\234\221\027\356\362\104\176\112\146\301\325\135\253\175\000\074"
	"\161\274\346\136\320\277\013\045\131\150\253\306\274\102\004\304"
	"\011\121\101\253\241\151\303\021\367\165\020\005\033\326\241\205"
	"\155\342\073\274\023\122\150\220\332\337\206\163\210\133\121\201"
	"\267\313\376\065\205\164\027\061\274\212\046\307\221\376\242\315"
	"\365\357\102\170\203\055\177\315\253\366\235\303\123\101\236\060"
	"\362\025\120\063\122\233\133\362\137\205\325\067\171\157\253\153"
	"\170\156\131\364\101\014\056\120\030\321\132\270\103\372\323\032"
	"\370\305\205\132\302\123\054\120\005\304\065\216\234\127\214\072"
	"\256\120\045\061\166\351\367\123\352\264\336\014\007\334\113\027"
	"\052\147\363\027\206\157\252\343\072\302\325\074\146\307\044\320"
	"\357\342\000\321\021\306\220\070\111\334\061\300\070\066\140\043"
	"\205\334\004\370\350\116\265\253\105\155\100\000\355\333\224\047"
	"\375\252\226\227\055\072\112\257\220\106\125\271\217\373\152\314"
	"\104\025\366\274\276\015\333\275\375\142\136\150\111\163\302\044"
	"\216\210\307\172\350\335\001\275\134\236\063\277\060\321\026\000"
	"\254\136\144\132\224\166\334\071\330\325\311\062\021\374\305\044"
	"\075\117\062\351\176\151\166\137\113\344\170\220\117\067\263\324"
	"\267\274\130\024\313\255\203\365\154\224\204\151\001\142\155\316"
	"\075\043\136\116\055\342\020\116\127\322\336\020\167\103\332\131"
	"\160\074\357\161\145\342\116\017\320\170\336\267\030\241\073\353"
	"\261\113\131\101\152\026\064\360\354\325\362\316\117\175\152\075"
	"\335\074\262\135\333\346\256\007\344\116\137\057\072\112\364\377"
	"\153\176\214\331\303\055\067\312\045\161\335\047\022\354\270\336"
	"\200\253\200\174\010\370\356\310\164\104\200\211\123\056\214\212"
	"\131\212\127\123\274\117\346\250\344\137\104\053\212\136\121\220"
	"\320\231\170\106\245\261\262\070\156\235\276\117\257\133\006\004"
	"\243\330\340\305\331\214\332\126\340\214\366\215\036\200\125\163"
	"\226\036\025\346\342\012\253\076\254\047\276\310\022\215\313\265"
	"\177\141\233\070\375\223\365\003\256\106\040\175\123\246\071\317"
	"\323\141\144\077\172\165\112\313\152\012\014\160\344\147\350\211"
	"\047\066\147\221\045\362\106\045\171\044\045\164\246\241\024\162"
	"\116\247\204\344\306\247\161\232\040\325\364\323\347\211\037\212"
	"\242\252\136\122\303\254\106\367\201\266\073\030\343\224\145\126"
	"\324\021\273\301\242\067\077\005\263\272\153\357\201\334\124\344"
	"\102\200\247\250\023\053\215\013\313\344\046\024\125\264\335\320"
	"\316\361\042\142\364\016\262\063\344\125\305\270\323\127\272\267"
	"\305\274\030\135\177\103\134\052\275\322\132\316\015\274\362\373"
	"\060\175\175\160\134\335\342\233\322\037\317\211\212\203\250\254"
	"\115\345\264\064\345\266\033\144\112\122\266\061\362\205\323\347"
	"\021\317\214\142\143\323\043\116\150\257\033\202\267\102\364\330"
	"\362\330\357\203\255\126\313\356\241\300\341\131\263\365\220\217"
	"\151\226\332\053\333\112\235\120\256\336\001\302\151\260\353\351"
	"\072\071\053\203\035\376\373\054\134\235\077\045\201\104\050\313"
	"\022\122\141\003\212\216\006\367\004\044\070\323\161\137\030\366"
	"\143\001\203\376\064\224\256\243\360\215\042\365\055\250\172\245"
	"\010\320\222\341\054\315\021\324\170\252\376\130\271\112\352\151"
	"\171\366\237\176\210\175\033\055\041\322\063\001\027\220\311\306"
	"\363\214\271\325\146\106\155\322\260\232\013\076\314\056\365\033"
	"\376\256\020\062\053\263\244\221\267\226\214\240\212\353\220\167"
	"\216\261\043\140\374\371\037\257\243\217\123\375\116\303\064\215"
	"\053\371\375\055\106\241\104\306\350\002\203\237\376\323\324\041"
	"\132\162\323\306\023\160\074\010\160\113\005\031\345\001\120\276"
	"\174\132\123\124\045\257\362\221\246\222\066\364\024\257\323\163"
	"\303\027\260\074\063\064\213\032\107\364\361\143\270\225\101\156"
	"\145\221\016\353\311\064\247\054\075\112\245\220\324\201\067\363"
	"\105\302\221\175\040\273\241\336\356\151\162\241\366\150\214\317"
	"\140\246\255\022\065\302\120\337\342\316\255\233\023\376\033\050"
	"\053\315\244\060\277\035\074\227\271\005\010\177\056\061\116\000"
	"\240\324\364\127\344\137\257\323\101\057\034\032\176\132\032\357"
	"\053\247\223\054\274\026\236\226\272\172\127\040\171\042\033\215"
	"\045\020\031\273\303\103\161\235\237\020\070\263\247\332\052\303"
	"\254\131\143\261\022\353\056\066\310\322\171\044\366\212\255\001"
	"\122\335\323\311\043\325\012\044\067\040\366\030\151\020\216\217"
	"\313\067\077\034\265\326\013\130\264\151\116\240\261\056\213\311"
	"\206\015\326\334\126\305\274\011\064\044\325\366\213\202\156\137"
	"\220\332\206\305\377\105\322\114\305\165\006\242\370\103\273\003"
	"\364\214\167\012\020\002\321\263\321\257\215\244\173\311\245\145"
	"\124\200\255\305\145\223\030\006\367\300\213\235\276\305\067\332"
	"\075\307\367\011\252\032\174\025\212\224\234\240\133\321\220\374"
	"\132\123\205\113\101\030\216\255\050\303\124\322\240\356\173\123"
	"\203\360\072\000\177\302\200\252\214\114\266\244\072\205\350\070"
	"\321\247\331\023\264\271\024\377\322\202\276\064\163\033\072\160"
	"\305\302\165\216\206\360\065\151\263\134\004\315\323\307\264\272"
	"\102\235\013\105\124\175\152\072\146\266\057\371\255\077\026\113"
	"\163\033\341\170\012\173\345\013\072\302\004\354\236\213\273\364"
	"\066\307\324\332\070\050\224\366\276\104\225\006\234\042\365\361"
	"\231\113\135\201\103\221\256\110\031\171\334\341\177\024\315\354"
	"\050\375\015\331\126\345\337\007\315\365\004\067\217\017\315\210"
	"\171\145\314\076\054\103\323\330\300\257\035\125\263\022\114\162"
	"\100\055\353\337\111\126\043\227\254\226\071\073\305\160\331\304"
	"\315\276\175\341\236\235\223\017\246\071\161\336\016\005\247\061"
	"\123\062\243\316\165\206\162\030\160\125\121\136\147\056\032\172"
	"\223\036\165\120\132\253\337\025\010\214\170\255\350\307\164\003"
	"\033\024\024\004\236\207\210\371\114\015\147\221\240\274\243\167"
	"\062\267\020\075\257\233\376\261\207\360\304\051\346\136\155\346"
	"\012\173\004\022\057\270\132\172\103\053\013\176\112\370\251\040"
	"\246\362\072\074\235\331\126\136\207\044\147\271\133\242\146\122"
	"\177\202\254\146\271\146\230\252\300\162\350\356\013\332\241\270"
	"\051\136\225\217\020\347\135\010\310\317\152\301\103\020\124\157"
	"\376\267\141\314\141\351\126\010\211\002\117\356\033\375\204\026"
	"\032\263\360\143\230\350\337\371\116\137\334\143\246\122\060\234"
	"\144\345\231\240\305\062\312\144\143\116\145\265\355\304\307\134"
	"\170\044\021\055\352\013\374\205\105\173\203\277\156\246\140\333"
	"\334\043\065\011\033\143\242\162\155\240\267\120\345\206\024\126"
	"\077\013\261\273\005\317\073\347\336\322\257\161\014\067\166\357"
	"\120\102\376\302\277\122\056\175\350\363\146\134\266\314\313\365"
	"\226\134\004\317\144\003\201\233\256\165\312\203\204\065\174\060"
	"\062\304\376\136\242\332\033\033\343\252\020\164\330\337\017\325"
	"\107\121\375\031\337\022\227\303\110\240\202\203\062\355\252\357"
	"\266\241\077\206\152\110\330\273\317\335\173\220\116\125\000\200"
	"\314\341\155\020\074\267\200\226\240\357\030\321\054\271\360\100"
	"\130\155\343\037\052\312\117\107\172\072\033\200\141\044\320\034"
	"\204\027\047\314\072\365\025\056\166\140\343\121\145\104\130\125"
	"\177\367\264\066\142\116\267\156\172\240\353\330\327\236\277\203"
	"\206\343\117\271\265\317\032\244\166\347\225\266\270\272\050\305"
	"\334\302\003\231\155\340\061\113\310\252\037\222\214\141\203\177"
	"\015\026\101\043\237\107\232\136\074\170\240\050\155\126\321\173"
	"\262\325\206\077\340\046\034\107\226\235\241\214\213\131\331\023"
	"\124\325\164\214\230\060\122\367\335\077\105\330\050\235\100\233"
	"\231\030\216\171\153\232\060\107\343\110\316\012\315\330\127\332"
	"\155\100\360\276\140\037\263\171\310\003\256\257\021\070\112\005"
	"\142\037\023\272\207\200\220\273\030\257\041\005\330\255\112\035"
	"\304\163\366\311\104\376\031\020\307\003\256\303\015\274\156\312"
	"\241\136\367\077\151\037\114\054\014\101\151\045\236\170\147\222"
	"\353\024\236\066\277\047\035\051\223\352\230\210\303\246\051\024"
	"\360\264\140\227\125\000\216\225\302\006\351\331\230\301\372\153"
	"\176\061\316\116\322\237\014\047\346\234\050\315\215\017\246\332"
	"\016\272\115\325\301\211\255\046\372\072\266\073\134\230\274\312"
	"\230\121\075\335\253\157\340\206\174\054\022\251\121\304\200\361"
	"\117\113\042\321\045\143\042\144\075\031\156\252\241\364\037\050"
	"\143\144\331\331\157\114\237\055\247\066\033\322\301\362\111\141"
	"\333\052\027\246\032\155\204\323\170\056\256\174\173\233\065\362"
	"\156\024\027\222\273\366\336\374\360\242\260\046\220\172\164\161"
	"\041\224\016\141\103\026\146\155\264\114\030\156\277\274\236\322"
	"\361\255\347\300\020\173\040\010\277\353\273\272\033\177\014\012"
	"\265\023\042\253\130\235\367\003\230\153\025\252\330\202\164\114"
	"\052\360\364\244\306\115\203\351\104\165\015\273\014\245\016\301"
	"\105\214\352\326\302\102\161\066\143\010\261\310\042\275\136\300"
	"\225\205\344\033\321\022\204\000\327\160\202\176\303\363\020\023"
	"\176\232\005\006\174\165\351\173\072\265\374\334\142\164\065\213"
	"\272\306\157\257\010\324\317\275\140\163\040\166\114\214\031\306"
	"\105\372\025\050\332\142\226\113\144\321\300\025\113\100\325\307"
	"\320\070\337\122\211\221\121\036\000\337\126\144\324\363\040\160"
	"\165\231\005\115\213\154\052\274\263\263\336\117\321\327\203\306"
	"\275\323\136\202\213\151\275\024\340\117\021\217\370\275\112\240"
	"\162\117\307\173\153\337\024\004\233\173\141\101\110\113\025\167"
	"\106\254\230\273\242\216\125\013\263\033\230\255\034\073\241\327"
	"\111\252\367\252\276\352\165\314\142\314\372\014\332\066\254\174"
	"\047\162\214\121\072\036\023\202\276\120\372\156\071\077\247\372"
	"\043\326\353\333\132\267\373\374\153\054\003\127\020\141\316\120"
	"\340\004\034\313\370\075\157\132\020\117\266\064\162\134\161\377"
	"\231\125\176\352\262\330\355\047\235\075\067\340\203\025\074\240"
	"\273\215\123\075\221\141\056\111\336\103\052\346\230\106\221\031"
	"\125\243\363\035\017\267\274\070\256\076\106\077\256\221\125\251"
	"\371\123\363\364\223\345\277\212\117\234\051\340\131\116\317\224"
	"\344\063\276\146\151\174\056\146\055\341\330\253\273\332\107\014"
	"\342\315\207\052\345\246\072\064\220\173\132\334\321\164\170\075"
	"\346\216\042\026\234\010\153\216\240\171\052\056\224\271\304\100"
	"\313\262\123\330\025\027\215\274\066\066\203\371\311\071\074\247"
	"\377\255\060\305\174\015\020\045\335\130\122\114\332\350\300\374"
	"\167\164\151\375\140\165\025\042\121\114\077\353\127\221\361\023"
	"\141\012\117\142\167\074\230\005\224\030\365\275\101\125\062\106"
	"\225\257\021\241\300\037\046\161\241\006\051\203\110\310\364\357"
	"\336\351\254\140\064\044\302\277\054\120\013\317\123\232\237\036"
	"\126\044\210\264\074\056\145\317\146\115\032\037\327\053\164\027"
	"\256\214\105\126\034\127\014\251\136\002\113\215\374\150\005\133"
	"\306\076\220\076\027\304\000\300\263\207\244\156\326\076\146\012"
	"\160\157\361\147\024\222\364\234\017\251\222\010\205\016\353\300"
	"\056\074\010\374\200\241\365\124\237\276\225\044\303\352\050\347"
	"\111\273\160\346\231\110\273\033\330\063\103\245\230\211\357\255"
	"\307\107\272\227\155\255\310\360\257\125\374\266\013\173\100\042"
	"\012\317\343\030\325\271\101\153\223\201\145\321\126\003\140\116"
	"\142\174\250\255\231\076\137\113\351\255\326\322\375\225\110\256"
	"\216\227\107\005\044\032\214\371\312\127\264\056\311\077\047\047"
	"\351\201\041\307\223\213\141\154\107\041\376\242\021\035\166\026"
	"\002\156\271\322\022\075\107\071\263\213\317\373\161\142\072\251"
	"\162\351\275\302\041\165\343\356\065\357\263\103\306\250\305\211"
	"\047\216\145\101\367\216\053\353\062\264\341\164\026\025\124\115"
	"\274\230\364\331\062\123\136\164\066\074\354\140\143\157\064\332"
	"\063\015\353\061\026\356\042\377\143\264\111\047\170\213\170\210"
	"\203\233\115\275\135\041\163\366\244\062\037\370\222\231\231\374"
	"\250\041\304\057\107\334\125\117\110\367\322\064\231\203\116\175"
	"\072\117\335\371\324\144\047\224\233\073\233\067\241\045\143\167"
	"\303\231\116\335\060\344\304\014\335\300\155\065\352\126\154\010"
	"\271\153\051\346\141\354\263\061\247\131\135\304\023\217\040\312"
	"\275\241\247\155\116\337\044\020\372\016\133\261\217\031\027\131"
	"\205\110\245\253\275\003\070\203\217\337\315\161\140\016\375\204"
	"\331\103\304\027\157\202\360\005\015\350\105\213\102\013\324\303"
	"\017\076\175\060\344\056\346\271\163\123\142\176\022\100\026\315"
	"\271\154\372\043\147\012\177\327\151\146\110\145\125\117\325\362"
	"\032\354\215\166\117\144\140\104\101\017\024\244\315\137\061\165"
	"\030\162\076\223\334\013\156\263\162\311\005\221\151\201\075\343"
	"\114\331\341\056\023\046\134\241\110\162\123\043\011\265\221\337"
	"\102\133\232\362\332\346\316\062\177\054\250\005\365\066\344\277"
	"\042\055\254\140\025\050\357\076\145\072\073\224\347\223\153\121"
	"\145\177\274\371\115\301\307\133\104\245\167\317\125\121\024\157"
	"\203\265\144\162\163\003\030\343\204\315\043\121\163\272\254\262"
	"\031\375\220\317\103\011\330\052\331\347\160\275\137\256\304\076"
	"\016\344\252\235\163\077\276\350\321\377\137\335\374\001\311\104"
	"\277\316\331\317\161\002\231\054\143\321\362\072\354\103\031\007"
	"\166\271\351\067\150\257\202\345\146\213\162\106\317\252\125\341"
	"\230\317\374\113\353\374\341\055\365\133\245\051\111\004\334\343"
	"\011\130\003\021\310\236\101\317\037\254\165\075\110\121\245\241"
	"\342\116\247\267\337\361\354\034\015\173\316\167\106\017\352\231"
	"\202\136\114\307\011\001\107\132\356\210\120\126\142\132\350\312"
	"\314\350\242\201\142\372\342\340\134\027\300\041\363\151\373\024"
	"\124\322\356\220\057\173\011\232\116\224\355\120\103\231\261\211"
	"\067\344\316\023\064\376\016\372\102\032\125\137\163\225\272\055"
	"\327\032\223\000\241\166\365\044\126\151\072\223\223\332\371\371"
	"\371\033\030\210\151\365\341\331\216\222\340\145\352\340\353\223"
	"\074\340\276\310\240\276\171\065\174\362\051\177\015\042\170\006"
	"\075\220\217\247\206\160\200\025\002\140\172\354\101\145\200\175"
	"\106\076\106\347\375\300\034\171\263\105\371\300\150\161\307\246"
	"\002\126\116\210\306\316\236\311\057\030\266\160\176\066\356\304"
	"\165\065\254\162\365\310\354\250\015\345\151\166\127\060\035\132"
	"\206\153\342\115\071\200\026\150\231\315\331\030\003\307\334\171"
	"\374\210\354\362\121\330\233\137\276\004\325\026\064\362\160\273"
	"\135\123\011\227\324\037\000\155\354\331\206\360\240\142\151\235"
	"\353\126\217\075\056\053\234\355\057\162\003\144\144\164\040\302"
	"\307\051\132\234\111\132\012\066\063\220\047\324\363\221\161\336"
	"\347\001\034\026\054\270\003\134\052\007\300\217\174\341\122\103"
	"\012\254\340\124\006\352\212\072\172\261\016\155\103\200\114\052"
	"\201\150\100\255\041\103\011\114\113\312\334\307\253\056\013\266"
	"\333\353\012\342\326\225\034\121\107\053\276\212\253\013\264\055"
	"\164\364\333\226\070\344\342\204\257\276\114\133\355\127\021\310"
	"\103\034\253\032\261\310\153\371\363\052\203\237\065\070\314\252"
	"\055\250\100\146\215\043\352\074\341\066\227\317\216\251\227\322"
	"\305\103\354\167\013\130\161\377\202\365\236\270\055\153\142\133"
	"\023\243\301\240\306\253\335\250\342\165\167\161\036\017\103\344"
	"\122\060\134\135\210\315\134\012\303\373\303\360\147\046\113\173"
	"\311\015\034\220\271\371\070\233\156\257\014\215\276\117\162\020"
	"\200\316\156\010\234\313\023\137\307\326\120\056\374\234\252\306"
	"\252\306\126\143\300\216\376\057\076\013\274\375\133\057\016\333"
	"\376\174\343\232\110\367\372\017\316\113\075\312\350\347\221\222"
	"\256\347\365\156\166\364\235\265\377\132\262\132\211\300\065\207"
	"\075\031\042\205\021\035\224\337\150\322\252\121\272\073\343\150"
	"\043\331\326\231\315\164\117\314\316\001\047\127\302\134\336\377"
	"\166\001\205\207\036\032\147\207\355\021\330\247\114\274\017\160"
	"\225\346\011\142\132\131\057\050\132\126\200\035\263\136\034\052"
	"\140\242\262\176\274\031\005\251\053\336\121\167\232\141\347\057"
	"\107\361\222\242\112\302\313\245\031\113\302\315\252\337\367\012"
	"\201\252\210\076\303\216\350\356\154\071\146\006\233\116\066\343"
	"\100\311\205\213\213\121\060\244\234\362\162\107\322\151\121\124"
	"\023\332\222\327\151\173\306\325\265\055\334\120\173\023\063\274"
	"\334\271\107\150\012\167\015\247\152\177\356\074\350\100\220\374"
#define      msg1_z	65
#define      msg1	((&data[4453]))
	"\203\236\153\174\257\357\321\117\104\237\040\254\057\064\035\337"
	"\211\165\164\113\027\070\377\043\172\015\204\037\337\201\276\163"
	"\327\046\332\001\120\123\137\255\373\154\213\271\223\074\133\275"
	"\047\054\007\253\246\053\240\305\003\324\012\363\123\255\354\147"
	"\220\124\205\232\131\124\310\066\244\103\111\330\377\045\221\107"
	"\216"
#define      msg2_z	19
#define      msg2	((&data[4535]))
	"\104\051\032\275\306\336\234\042\111\243\312\066\266\257\331\226"
	"\130\046\125\022\116\310\062\146\003"
#define      lsto_z	1
#define      lsto	((&data[4557]))
	"\124"
#define      chk1_z	22
#define      chk1	((&data[4558]))
	"\356\031\257\022\037\004\362\130\117\071\143\057\105\004\310\030"
	"\234\074\275\254\301\043\021\271\157\153"
#define      pswd_z	256
#define      pswd	((&data[4598]))
	"\262\173\353\212\173\021\034\302\237\271\201\072\375\252\353\344"
	"\232\012\114\247\346\306\210\223\237\326\135\216\246\317\215\233"
	"\214\136\234\173\073\171\222\144\234\253\006\311\363\361\256\215"
	"\373\372\064\342\300\275\165\140\224\323\357\072\242\175\326\057"
	"\333\163\252\027\354\075\173\211\350\201\122\334\163\000\151\156"
	"\373\236\121\273\134\307\034\360\232\013\053\074\211\001\153\144"
	"\164\026\173\141\124\367\352\075\171\075\031\354\075\203\133\070"
	"\042\254\364\176\163\021\157\015\034\232\112\246\233\266\012\020"
	"\315\206\161\041\176\133\136\370\231\170\344\326\373\100\017\035"
	"\354\004\234\140\025\014\156\062\247\271\330\102\157\343\123\075"
	"\152\304\137\350\040\275\340\271\066\305\220\062\005\237\117\362"
	"\244\354\123\271\370\301\353\237\172\304\342\352\247\066\047\021"
	"\372\206\372\033\104\332\325\173\240\145\255\246\005\375\231\251"
	"\351\354\143\342\256\117\202\051\023\145\023\273\233\073\314\226"
	"\302\307\261\007\242\207\202\102\354\057\351\362\054\202\234\026"
	"\157\377\370\035\116\173\107\142\340\132\035\174\226\352\022\131"
	"\261\304\140\123\113\343\226\070\023\177\052\077\001\307\124\060"
	"\020\130\243\007\130\061\042\054\102\333\233\256\351\322\120\233"
	"\115\073\046\311\114\102\213\353\374\014\046\371\266\173\052\307"
	"\323\315\316\053\376\361\127"
#define      shll_z	10
#define      shll	((&data[4897]))
	"\357\266\156\312\236\137\116\156\221\133\042\046\305\100"
#define      inlo_z	3
#define      inlo	((&data[4909]))
	"\020\147\375"
#define      tst1_z	22
#define      tst1	((&data[4917]))
	"\273\150\263\267\164\166\161\211\316\340\212\241\233\330\113\053"
	"\253\324\111\210\107\022\244\331\257\164\027\332\261\053\125"
#define      tst2_z	19
#define      tst2	((&data[4947]))
	"\251\301\124\247\176\164\357\176\200\272\325\233\343\022\163\217"
	"\347\201\103\277\374\156\366"
#define      rlax_z	1
#define      rlax	((&data[4966]))
	"\362"
#define      opts_z	1
#define      opts	((&data[4967]))
	"\164"
#define      chk2_z	19
#define      chk2	((&data[4969]))
	"\210\027\175\150\241\377\277\071\171\045\245\215\074\246\232\241"
	"\117\310\227\063"
#define      date_z	1
#define      date	((&data[4988]))
	"\364"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
