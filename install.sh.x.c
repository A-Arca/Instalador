#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -r -f install.sh -o install 
#endif

static  char data [] = 
#define      text_z	3453
#define      text	((&data[39]))
	"\343\057\272\074\074\023\037\157\126\362\071\005\000\216\215\054"
	"\161\333\217\310\300\211\056\011\045\243\022\275\165\035\240\130"
	"\115\132\225\211\155\264\370\357\223\302\242\313\112\173\242\022"
	"\133\371\177\172\313\332\136\064\132\250\025\076\260\232\075\265"
	"\207\170\057\106\062\320\146\311\152\136\045\373\123\127\143\335"
	"\061\043\323\237\167\163\120\202\347\151\226\035\136\147\120\256"
	"\264\267\337\276\375\006\343\103\020\136\311\074\352\243\005\063"
	"\313\050\101\033\242\130\221\121\377\357\243\145\373\314\320\124"
	"\344\350\123\022\370\043\240\225\133\342\152\050\255\120\113\222"
	"\134\100\012\142\005\104\026\335\033\023\113\156\240\217\336\311"
	"\353\344\137\344\064\376\247\367\214\365\043\040\022\060\377\361"
	"\330\176\165\120\152\233\041\232\254\010\302\011\221\127\345\015"
	"\122\332\032\022\116\347\077\206\144\144\146\375\347\207\360\205"
	"\247\357\330\000\017\235\356\012\264\114\231\324\106\057\135\027"
	"\100\301\055\113\114\156\342\245\016\374\207\046\107\056\105\253"
	"\275\317\274\275\015\217\346\040\145\012\251\353\106\025\200\310"
	"\040\000\254\350\267\260\341\014\056\123\267\167\126\264\330\255"
	"\052\334\301\213\306\021\003\237\334\321\004\303\077\065\271\113"
	"\320\307\042\242\164\006\225\377\064\345\136\022\236\043\015\021"
	"\212\033\224\104\120\232\245\275\131\017\103\124\200\270\353\353"
	"\137\267\363\354\256\270\323\337\134\203\224\113\177\051\051\202"
	"\156\274\130\106\007\140\256\221\306\040\002\342\365\173\153\263"
	"\171\004\250\331\163\375\307\243\023\122\252\276\276\214\226\266"
	"\277\336\166\261\146\262\347\343\364\016\042\110\272\207\273\370"
	"\342\145\323\145\307\102\143\003\154\237\005\035\057\253\207\221"
	"\234\264\320\170\042\036\055\045\220\242\052\333\112\037\221\002"
	"\054\111\373\247\002\155\077\327\246\157\037\301\303\074\151\302"
	"\035\245\350\330\074\173\112\255\226\003\142\055\206\264\063\307"
	"\150\351\107\210\344\356\074\217\235\135\076\321\360\012\317\026"
	"\243\053\340\067\246\133\306\343\214\105\160\052\345\006\306\040"
	"\003\226\264\074\370\045\024\375\325\320\260\330\013\306\110\327"
	"\064\333\353\106\131\056\330\256\321\017\317\132\372\113\036\225"
	"\002\111\064\116\222\117\207\253\072\224\116\323\231\161\340\172"
	"\264\277\041\212\140\370\311\310\245\303\101\226\141\151\226\336"
	"\342\204\136\316\061\015\030\357\112\015\321\124\267\355\200\341"
	"\201\215\117\052\123\125\234\151\371\254\362\050\050\271\034\305"
	"\273\046\005\323\334\077\207\252\354\317\307\370\335\205\242\230"
	"\007\102\000\100\000\033\227\022\145\370\242\351\052\353\343\250"
	"\124\324\044\317\077\007\342\372\207\112\034\004\120\142\337\123"
	"\303\042\010\212\304\050\124\045\354\377\120\111\242\363\017\327"
	"\273\131\302\041\262\300\063\051\046\051\157\216\173\174\243\221"
	"\322\011\130\234\046\240\172\306\010\230\127\211\276\237\022\202"
	"\061\053\330\361\116\277\043\125\252\346\264\205\175\302\170\142"
	"\031\161\006\132\154\162\360\171\130\247\107\203\002\044\131\263"
	"\164\021\366\231\366\272\052\267\165\234\203\027\053\046\164\307"
	"\044\112\352\046\377\052\276\334\073\353\102\101\271\310\126\104"
	"\352\232\157\374\171\163\007\010\305\374\246\043\325\050\020\013"
	"\031\052\304\041\057\061\035\330\255\304\376\076\061\251\132\011"
	"\171\374\050\304\005\167\136\340\222\231\224\312\365\240\215\274"
	"\106\014\144\246\305\122\102\375\333\335\333\237\127\223\301\337"
	"\114\334\163\261\245\061\030\214\131\056\237\310\137\043\231\154"
	"\265\330\340\321\206\033\063\276\074\166\373\361\235\132\360\367"
	"\115\267\150\006\272\147\056\062\156\007\371\016\000\117\174\361"
	"\104\272\063\341\163\203\333\154\273\132\133\360\247\357\305\335"
	"\250\242\274\236\043\106\254\347\046\161\235\214\303\333\210\272"
	"\045\323\301\031\370\264\305\102\226\206\034\320\225\310\230\356"
	"\142\144\355\127\335\210\200\047\011\353\245\267\125\122\070\331"
	"\222\230\247\030\264\226\217\315\072\316\336\047\275\247\131\354"
	"\174\251\013\314\240\351\005\142\255\115\357\033\377\145\367\364"
	"\011\357\073\151\320\154\345\304\021\207\116\247\012\071\053\027"
	"\055\124\347\272\127\340\275\233\364\146\276\210\170\046\133\243"
	"\206\167\324\000\317\201\121\104\322\255\321\035\307\154\340\257"
	"\334\300\053\255\274\076\324\327\254\220\107\331\157\020\260\070"
	"\070\230\103\326\352\003\110\352\165\252\355\211\301\240\003\146"
	"\122\017\306\355\214\075\252\135\132\007\104\341\137\272\102\206"
	"\131\332\317\311\073\151\230\336\075\237\277\367\325\372\345\253"
	"\341\073\120\222\156\357\345\040\340\264\230\360\157\364\332\007"
	"\010\066\203\131\344\066\272\255\176\220\341\330\226\300\321\270"
	"\103\307\326\276\361\375\045\314\151\364\051\134\214\252\344\305"
	"\243\142\010\142\377\056\171\255\076\351\257\335\004\137\352\276"
	"\377\145\301\005\026\140\333\115\043\251\045\352\114\136\371\326"
	"\073\371\161\237\315\360\072\304\251\125\133\026\373\322\022\230"
	"\135\247\304\037\123\045\312\165\366\374\151\321\277\221\073\155"
	"\241\004\307\315\060\275\117\212\075\126\145\146\067\242\251\077"
	"\200\100\377\171\144\250\100\364\011\213\130\236\045\344\266\344"
	"\255\200\107\277\121\262\145\064\045\157\262\352\110\072\373\301"
	"\052\355\370\334\220\175\374\043\151\017\025\240\300\170\006\275"
	"\312\327\254\036\173\011\327\134\351\226\053\140\164\202\247\025"
	"\334\246\362\066\011\176\231\074\040\111\230\122\355\176\036\342"
	"\176\260\204\306\175\106\016\055\256\100\174\176\140\046\045\360"
	"\375\232\354\111\131\313\077\213\175\365\004\337\204\213\036\142"
	"\245\352\121\266\233\204\151\041\031\044\045\277\224\043\144\365"
	"\031\010\326\020\201\104\167\322\315\015\220\330\246\121\011\164"
	"\166\024\027\125\010\374\122\170\305\044\022\344\201\342\023\265"
	"\157\001\062\232\053\134\350\357\272\230\160\004\125\234\360\267"
	"\101\026\030\033\362\141\217\302\174\260\031\211\146\053\306\300"
	"\076\040\346\132\030\132\023\063\037\173\133\150\110\100\110\176"
	"\113\001\365\175\353\054\172\107\061\107\064\357\305\065\074\113"
	"\321\060\134\132\263\276\367\210\274\162\172\135\343\170\116\312"
	"\173\316\304\354\071\251\007\214\233\045\002\277\037\001\271\001"
	"\070\102\177\337\176\074\000\300\005\241\355\303\244\055\124\176"
	"\107\221\352\207\236\276\240\327\256\253\253\310\124\017\070\306"
	"\251\164\375\205\256\105\044\221\056\324\303\374\064\117\312\016"
	"\055\354\106\332\112\231\042\155\054\165\205\027\016\347\216\260"
	"\012\130\156\330\254\336\361\317\122\275\230\007\110\322\353\265"
	"\230\275\123\237\274\157\233\352\030\132\064\370\341\243\112\124"
	"\063\107\312\301\236\242\101\253\001\062\211\021\225\377\320\230"
	"\014\030\244\023\275\371\077\253\007\273\170\336\247\130\153\365"
	"\275\322\262\222\136\236\071\032\325\222\262\124\320\165\017\206"
	"\312\244\065\010\254\322\013\301\365\324\221\201\153\004\357\215"
	"\202\161\106\072\012\005\366\166\072\165\030\376\366\351\062\217"
	"\121\065\356\277\202\004\103\161\121\056\360\211\070\312\125\136"
	"\267\304\266\303\107\040\164\125\030\164\114\260\046\367\026\231"
	"\240\044\160\132\256\350\333\007\136\325\134\042\171\376\326\060"
	"\112\040\301\250\276\204\371\320\212\351\367\124\222\360\277\350"
	"\121\043\025\250\353\262\300\073\330\166\263\263\123\242\205\337"
	"\103\121\271\010\242\046\177\117\014\123\331\221\060\014\330\036"
	"\035\126\221\021\201\337\210\206\122\225\330\033\226\320\245\130"
	"\347\315\301\327\154\066\337\370\167\312\320\245\040\242\001\100"
	"\362\332\152\263\064\006\265\245\221\152\371\301\337\162\277\172"
	"\001\255\016\122\362\055\072\340\074\110\135\271\243\260\330\033"
	"\223\017\171\145\157\126\255\053\372\333\222\324\375\344\343\266"
	"\013\306\102\174\171\241\005\270\240\062\260\054\274\176\002\255"
	"\374\102\232\240\232\147\105\274\333\351\014\026\261\300\315\151"
	"\351\110\330\042\046\267\025\364\350\103\162\176\037\325\216\335"
	"\006\117\141\321\257\333\154\327\004\147\302\346\210\265\063\051"
	"\105\132\063\043\316\353\333\131\263\247\044\135\153\256\234\061"
	"\335\245\331\307\335\153\335\176\004\157\324\140\331\143\120\036"
	"\254\050\061\132\011\201\175\364\201\267\111\266\246\145\113\344"
	"\053\201\234\154\076\077\254\352\237\216\063\264\255\166\340\115"
	"\035\102\301\002\343\177\271\223\125\016\221\156\256\054\025\130"
	"\000\100\033\203\355\054\264\142\333\214\204\005\367\353\116\305"
	"\377\155\164\154\310\323\134\371\331\125\341\054\267\000\303\347"
	"\161\153\001\324\150\227\063\022\212\326\370\243\127\161\144\136"
	"\012\215\264\106\264\252\244\361\216\217\173\345\077\267\274\200"
	"\304\021\102\220\313\267\020\236\040\377\306\244\122\234\312\162"
	"\145\364\073\050\343\037\007\357\177\370\041\032\135\156\112\065"
	"\307\272\363\345\374\025\241\355\007\204\056\265\266\026\206\376"
	"\215\015\311\026\302\257\003\311\327\030\027\244\270\355\150\057"
	"\351\222\276\057\121\212\321\223\024\016\121\072\333\165\225\270"
	"\012\123\221\245\033\261\117\011\160\114\076\037\265\067\106\231"
	"\230\322\252\270\254\330\133\207\227\230\263\201\316\145\177\025"
	"\003\061\075\233\213\226\175\144\175\204\035\155\135\244\200\363"
	"\123\227\315\366\155\362\264\167\114\230\366\265\146\350\267\156"
	"\116\312\043\165\153\200\114\026\366\152\024\150\043\111\327\116"
	"\267\046\220\330\053\176\312\356\006\275\121\310\246\325\171\226"
	"\040\363\020\002\154\150\041\040\042\366\301\362\205\035\056\063"
	"\131\204\225\302\207\217\007\034\113\247\271\357\345\223\200\047"
	"\107\331\372\225\163\003\362\153\205\233\274\163\360\270\347\007"
	"\104\312\150\206\036\237\371\114\157\034\367\056\171\133\225\233"
	"\142\140\102\365\216\340\103\022\331\072\374\224\372\136\117\002"
	"\064\172\034\076\143\322\363\167\013\026\060\266\314\366\134\145"
	"\175\145\077\362\236\043\331\330\152\377\214\373\206\220\366\020"
	"\102\143\367\363\262\350\246\367\051\252\031\075\003\171\337\026"
	"\150\115\200\234\065\171\133\057\312\157\141\061\105\272\342\142"
	"\035\341\240\260\044\146\205\034\037\061\354\272\067\211\303\070"
	"\325\134\211\113\274\316\170\137\143\025\346\015\203\044\072\115"
	"\222\147\110\113\004\005\250\210\340\321\250\135\016\221\041\052"
	"\135\303\013\374\253\227\162\172\257\171\362\377\025\256\060\200"
	"\075\016\131\154\135\154\334\076\146\221\035\205\245\100\144\300"
	"\221\360\066\176\131\136\013\171\177\171\024\002\212\023\166\300"
	"\276\303\354\050\210\212\230\270\346\370\164\376\206\115\110\305"
	"\231\047\155\222\060\147\215\362\116\065\374\153\237\316\147\353"
	"\172\115\007\251\247\015\007\074\337\047\222\053\014\160\004\270"
	"\003\225\313\157\304\062\366\027\012\333\244\366\170\104\243\215"
	"\010\114\021\251\075\367\365\276\164\174\014\337\170\045\340\163"
	"\004\141\367\174\054\206\227\071\316\250\310\243\056\165\044\305"
	"\222\150\341\300\106\213\130\101\167\154\044\031\353\130\042\253"
	"\221\105\163\335\373\112\214\303\070\033\166\252\136\305\065\160"
	"\234\331\377\331\332\033\106\001\113\246\373\076\156\267\343\217"
	"\235\142\100\255\153\326\015\275\323\032\176\267\156\230\174\316"
	"\025\333\304\074\237\357\221\311\137\366\205\301\124\104\002\301"
	"\232\170\311\032\137\070\127\051\007\264\336\030\333\006\365\101"
	"\011\336\143\240\172\123\370\062\152\145\025\004\266\154\373\241"
	"\304\010\306\265\263\225\364\325\213\326\032\116\224\341\147\101"
	"\324\334\322\360\061\275\062\272\141\022\042\204\166\037\236\171"
	"\106\325\076\173\177\027\366\236\303\341\263\323\124\042\035\225"
	"\304\222\234\211\154\104\210\303\024\206\221\074\342\300\070\354"
	"\307\362\052\232\020\133\124\354\320\363\265\330\257\035\055\261"
	"\072\354\301\135\300\010\142\003\161\161\027\244\002\055\362\261"
	"\023\015\345\336\311\134\334\115\030\176\101\135\206\224\063\076"
	"\260\175\050\341\133\234\314\075\346\157\303\141\166\314\371\350"
	"\364\226\062\345\171\107\054\266\072\257\356\163\062\053\140\132"
	"\067\236\211\135\330\111\374\200\052\012\311\147\056\365\360\063"
	"\305\124\314\233\233\145\000\110\224\330\072\044\347\237\354\020"
	"\306\366\036\023\235\204\336\310\123\014\150\173\212\104\130\174"
	"\132\232\147\265\015\123\074\153\116\231\332\161\332\072\216\052"
	"\365\275\047\316\332\210\203\044\371\136\217\006\276\222\251\154"
	"\134\312\362\012\367\101\001\172\265\001\222\123\025\067\034\122"
	"\150\157\277\254\236\044\152\200\221\066\022\230\335\071\277\223"
	"\155\036\050\102\215\020\155\120\163\047\304\361\377\304\212\233"
	"\246\127\235\006\114\121\024\030\273\035\166\076\042\116\273\330"
	"\202\020\333\032\050\172\331\232\017\314\323\270\326\170\230\047"
	"\227\243\342\331\252\177\117\254\224\250\143\152\322\166\015\075"
	"\166\222\023\154\065\100\227\345\224\311\121\144\341\105\331\221"
	"\005\333\015\117\235\046\136\235\122\111\107\321\216\365\333\336"
	"\236\042\211\105\061\122\260\003\227\245\271\106\214\200\227\307"
	"\064\001\216\167\027\246\376\204\165\377\365\067\120\360\310\017"
	"\153\233\230\372\174\172\352\374\362\046\173\311\105\102\034\342"
	"\003\172\317\156\361\051\034\360\271\222\241\016\172\332\300\253"
	"\326\223\222\323\223\203\012\206\216\255\276\243\152\357\032\007"
	"\107\311\223\347\376\350\231\010\271\220\013\075\073\167\015\262"
	"\202\260\143\303\155\060\172\006\334\235\012\372\113\376\320\072"
	"\073\071\354\156\310\133\254\063\124\300\137\035\207\170\031\074"
	"\077\007\104\141\316\056\270\104\110\342\113\232\300\272\356\203"
	"\163\055\300\124\110\363\035\004\257\044\043\147\330\243\140\330"
	"\106\372\042\244\075\162\075\203\177\156\244\172\347\210\243\222"
	"\173\016\061\043\152\074\241\115\303\355\033\235\140\340\044\213"
	"\217\204\303\040\345\313\153\243\143\004\154\123\024\066\115\031"
	"\146\275\013\275\314\246\125\173\353\214\211\355\345\357\101\151"
	"\212\275\021\004\121\162\011\312\053\360\142\300\070\343\066\241"
	"\217\133\324\203\340\073\166\367\067\131\126\013\320\177\233\341"
	"\367\207\263\163\120\251\304\272\125\376\207\277\276\325\036\170"
	"\156\311\372\006\131\046\130\225\245\043\267\031\223\002\207\176"
	"\226\367\073\250\043\267\211\006\204\220\123\244\076\254\270\020"
	"\157\024\000\372\275\370\031\376\005\125\173\322\313\261\101\211"
	"\076\062\327\142\066\355\306\331\074\346\353\074\025\143\123\236"
	"\154\247\006\144\353\363\100\040\161\107\331\003\047\065\016\340"
	"\127\347\142\371\311\277\072\171\046\013\063\230\300\165\055\050"
	"\142\332\135\274\136\262\267\013\323\225\246\015\011\077\171\373"
	"\224\251\072\160\140\053\111\131\242\211\214\372\235\005\350\345"
	"\257\311\212\145\243\215\343\160\022\356\321\242\327\176\361\361"
	"\210\346\143\330\174\066\167\073\055\262\354\013\160\030\336\353"
	"\373\204\144\212\071\075\072\036\175\137\352\311\255\047\367\054"
	"\052\020\370\000\243\274\155\043\236\020\255\171\300\253\261\060"
	"\317\166\231\310\063\103\107\136\163\061\074\031\235\167\170\332"
	"\310\244\125\353\206\272\072\075\372\122\336\313\165\341\107\322"
	"\035\370\260\361\124\133\272\167\167\234\370\054\363\305\046\026"
	"\313\157\101\302\303\246\062\311\246\300\126\323\062\062\142\372"
	"\362\354\051\373\021\315\016\317\102\053\160\233\171\312\060\003"
	"\067\344\373\373\213\055\304\061\356\033\005\040\115\150\033\100"
	"\125\105\074\147\022\112\067\125\166\247\360\357\161\040\362\251"
	"\005\356\244\220\034\150\302\012\204\310\053\321\060\107\021\206"
	"\214\116\355\236\230\044\363\016\314\344\376\075\005\361\347\013"
	"\337\213\234\374\364\136\006\170\047\062\112\130\171\134\336\005"
	"\252\314\244\102\361\230\121\275\174\117\372\202\100\342\215\040"
	"\155\051\034\141\210\043\332\257\125\044\007\317\201\346\324\053"
	"\262\171\155\243\021\276\140\215\016\133\020\117\075\235\157\253"
	"\306\214\015\117\260\350\376\006\014\006\325\215\355\252\271\237"
	"\043\046\103\064\345\244\302\364\000\322\103\076\160\263\351\066"
	"\077\367\206\360\337\204\366\354\213\313\172\170\166\063\030\231"
	"\132\134\316\077\000\221\064\001\143\167\077\324\052\051\012\152"
	"\040\221\132\377\025\121\353\241\035\145\032\223\230\063\055\362"
	"\217\373\062\220\214\146\221\360\335\320\304\010\371\317\163\031"
	"\140\316\031\166\037\004\027\074\151\062\320\002\145\375\364\364"
	"\371\047\205\205\215\026\166\153\347\073\164\341\012\347\373\153"
	"\265\024\341\324\030\371\021\202\053\341\204\221\337\171\205\330"
	"\240\013\136\056\041\324\231\011\017\015\352\032\365\346\205\252"
	"\372\147\177\023\140\220\226\214\162\032\035\121\224\243\051\065"
	"\256\207\143\320\134\375\331\154\013\304\207\000\252\015\252\245"
	"\164\051\270\325\272\116\142\054\151\177\175\376\043\246\063\322"
	"\056\226\242\213\223\174\367\236\100\177\237\353\214\112\220\000"
	"\163\111\326\056\230\070\132\001\270\330\000\333\177\063\255\256"
	"\311\120\071\135\314\061\374\015\260\233\371\074\345\211\075\131"
	"\323\023\210\153\113\342\155\004\273\155\337\072\240\215\350\152"
	"\335\042\310\252\123\304\270\003\140\261\100\106\072\175\240\016"
	"\220\050\171\334\013\347\340\306\124\300\001\365\115\351\140\053"
	"\013\050\326\137\355\216\142\116\077\243\224\172\040\064\210\261"
	"\134\002\215\147\351\156\056\075\056\057\063\174\031\223\250\045"
	"\274\176\204\251\014\347\367\113\212\214\306\252\300\116\133\035"
	"\120\351\205\071\130\263\167\207\343\253\003\374\076\254\041\373"
	"\052\245\245\067\214\234\203\027\051\111\301\351\230\035\007\350"
	"\007\214\042\137\100\232\346\043\105\352\037\204\226\101\177\301"
	"\347\044\371\164\301\174\213\352\306\114\324\136\152\333\106\161"
	"\147\151\321\247\003\267\313\110\242\352\314\071\054\113\372\023"
	"\160\363\207\061\160\022\034\066\137\360\224\312\313\333\074\062"
	"\104\015\332\110\305\245\220\147\220\135\240\274\251\233\320\031"
	"\217\127\113\377\152\147\066\312\127\313\225\042\246\321\125\353"
	"\337\057\063\244\325\303\013\145\041\254\042\312\110\362\343\327"
	"\112\056\327\265\226\016\200\355\331\025\020\200\347\145\153\306"
	"\225\236\152\152\142\166\320\203\043\362\115\153\345\061\103\057"
	"\140\033\345\366\051\145\343\002\173\363\202\142\131\356\051\356"
	"\215\223\130\360\012\051\164\056\033\302\232\000\363\335\060\123"
	"\370\025\112\042\172\056\045\365\042\250\130\173\226\201\152\044"
	"\025\302\024\037\354\210\116\007\112\350\010\076\305\070\222\276"
	"\115\334\341\310\012\006\276\055\256\026\250\105\227\022\152"
#define      rlax_z	1
#define      rlax	((&data[4255]))
	"\024"
#define      tst2_z	19
#define      tst2	((&data[4259]))
	"\033\311\121\263\327\243\344\232\143\034\175\131\367\151\103\054"
	"\123\246\305\241\234\307"
#define      pswd_z	256
#define      pswd	((&data[4331]))
	"\311\012\042\207\130\376\151\041\011\157\337\066\036\366\337\144"
	"\216\362\316\073\310\114\010\212\123\043\123\245\046\045\065\360"
	"\057\127\167\210\126\340\251\140\120\210\227\157\176\166\323\015"
	"\151\241\110\061\356\332\172\150\336\143\115\212\077\215\002\036"
	"\344\323\305\171\377\216\227\313\374\343\110\251\354\324\322\112"
	"\105\144\075\127\076\270\277\034\033\015\246\133\233\251\172\200"
	"\175\077\371\175\316\221\111\312\164\221\164\141\145\107\253\253"
	"\253\350\003\352\240\303\006\274\320\255\030\153\127\222\353\325"
	"\321\344\123\237\166\234\152\353\055\337\114\223\046\370\076\322"
	"\340\102\274\201\005\303\076\325\161\127\100\311\351\054\236\273"
	"\021\361\133\207\215\306\162\273\245\277\117\313\267\216\236\230"
	"\320\132\032\325\036\130\253\217\257\354\130\231\030\367\124\051"
	"\350\257\261\166\165\044\062\033\343\202\346\232\020\205\062\341"
	"\337\114\267\376\245\142\216\125\117\346\356\147\336\102\221\307"
	"\362\102\076\150\146\160\203\112\363\152\344\003\357\026\345\317"
	"\142\234\315\010\376\133\135\115\102\113\265\041\216\106\350\201"
	"\211\046\351\360\227\155\072\212\327\036\216\306\065\163\226\230"
	"\017\144\240\016\277\375\134\002\111\022\043\327\130\014\131\342"
	"\062\102\323\312\257\015\124\207\054\343\116\142\126\344\372\146"
	"\110\233\164\010\230\120\273\102\164\017\350\233\065\035\213\144"
	"\165\003\355\314\344\226\054\064\037\303\243\236\072\167\253\243"
	"\031\363\324\007\104\220\112\270\240"
#define      shll_z	10
#define      shll	((&data[4623]))
	"\206\276\173\016\224\111\260\371\157\021\121\337"
#define      inlo_z	3
#define      inlo	((&data[4635]))
	"\165\105\256"
#define      date_z	1
#define      date	((&data[4638]))
	"\145"
#define      opts_z	1
#define      opts	((&data[4639]))
	"\160"
#define      chk2_z	19
#define      chk2	((&data[4642]))
	"\173\274\027\021\226\117\376\040\252\355\253\125\031\126\273\121"
	"\207\166\270\170\203\026\046\140"
#define      xecc_z	15
#define      xecc	((&data[4664]))
	"\300\307\301\224\234\276\157\315\057\337\157\277\007\347\220"
#define      lsto_z	1
#define      lsto	((&data[4679]))
	"\243"
#define      tst1_z	22
#define      tst1	((&data[4680]))
	"\332\224\316\241\140\373\370\363\041\201\216\312\173\273\133\053"
	"\320\366\276\341\217\047\265\154"
#define      chk1_z	22
#define      chk1	((&data[4704]))
	"\225\321\014\250\270\341\012\122\030\237\120\064\374\337\251\152"
	"\303\053\202\314\030\214\165"
#define      msg1_z	65
#define      msg1	((&data[4730]))
	"\140\365\133\143\166\354\160\153\231\250\334\137\374\352\137\331"
	"\220\167\341\015\256\014\126\056\064\002\255\056\156\163\166\202"
	"\101\132\375\224\156\031\020\352\373\217\306\054\261\261\044\323"
	"\064\076\312\135\337\076\306\162\134\325\077\312\244\205\064\145"
	"\053\210\041\370\040\360\070\242\217\264\137\245\332\277"
#define      msg2_z	19
#define      msg2	((&data[4809]))
	"\014\123\272\216\243\023\111\064\333\335\221\037\213\301\132\046"
	"\074\020\001\377\201\211\255\153\040\103\327"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
